<!DOCTYPE html>
<html lang="en"><head>
<script src="slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="slides_files/libs/quarto-html/popper.min.js"></script>
<script src="slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slides_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet">
<link href="slides_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.556">

  <title>slides</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="slides_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section class="slide level2">

<div class="cell">

</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Crosstab</caption>
<thead>
<tr class="header">
<th style="text-align: left;">sector</th>
<th style="text-align: right;">2016</th>
<th style="text-align: right;">2017</th>
<th style="text-align: right;">2018</th>
<th style="text-align: right;">2019</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: right;">325.48</td>
<td style="text-align: right;">278.88</td>
<td style="text-align: right;">252.67</td>
<td style="text-align: right;">226.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: right;">230.75</td>
<td style="text-align: right;">204.08</td>
<td style="text-align: right;">183.57</td>
<td style="text-align: right;">164.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: right;">116.00</td>
<td style="text-align: right;">111.22</td>
<td style="text-align: right;">107.68</td>
<td style="text-align: right;">80.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Public Sector Electricity</td>
<td style="text-align: right;">86.86</td>
<td style="text-align: right;">71.24</td>
<td style="text-align: right;">68.77</td>
<td style="text-align: right;">61.36</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Tidy</caption>
<thead>
<tr class="header">
<th style="text-align: left;">sector</th>
<th style="text-align: left;">year</th>
<th style="text-align: right;">territorial_emissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: left;">2016</td>
<td style="text-align: right;">325.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: left;">2016</td>
<td style="text-align: right;">230.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: left;">2016</td>
<td style="text-align: right;">116.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Public Sector Electricity</td>
<td style="text-align: left;">2016</td>
<td style="text-align: right;">86.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: left;">2017</td>
<td style="text-align: right;">278.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: left;">2017</td>
<td style="text-align: right;">204.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: left;">2017</td>
<td style="text-align: right;">111.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Public Sector Electricity</td>
<td style="text-align: left;">2017</td>
<td style="text-align: right;">71.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: left;">2018</td>
<td style="text-align: right;">252.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: left;">2018</td>
<td style="text-align: right;">183.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: left;">2018</td>
<td style="text-align: right;">107.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">Public Sector Electricity</td>
<td style="text-align: left;">2018</td>
<td style="text-align: right;">68.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: left;">2019</td>
<td style="text-align: right;">226.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: left;">2019</td>
<td style="text-align: right;">164.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: left;">2019</td>
<td style="text-align: right;">80.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Public Sector Electricity</td>
<td style="text-align: left;">2019</td>
<td style="text-align: right;">61.36</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>The useR! audience will be familiar with tidy data, the way we melt or unpivot cross-tabulations into long tables of observations to better work with the data.</p>
<p>Instead of communicating dimensions with the structure and layout of the table, we turn them into data - columns in a data frame that may be addressed and manipulated.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Years</caption>
<thead>
<tr class="header">
<th style="text-align: left;">year</th>
<th style="text-align: left;">start</th>
<th style="text-align: left;">end</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
</tr>
<tr class="even">
<td style="text-align: left;">2006</td>
<td style="text-align: left;">2006-01-01</td>
<td style="text-align: left;">2006-12-31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2007</td>
<td style="text-align: left;">2007-01-01</td>
<td style="text-align: left;">2007-12-31</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Units</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: left;">comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">KT-CO2</td>
<td style="text-align: left;">Kilotonnes of Carbon Dioxide</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Observations</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 31%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">year</th>
<th style="text-align: left;">area</th>
<th style="text-align: left;">sector</th>
<th style="text-align: right;">territorial_emissions</th>
<th style="text-align: left;">unit_of_measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: right;">77.19</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Commercial Gas</td>
<td style="text-align: right;">16.69</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Commercial ‘Other Fuels’</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: right;">80.64</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Domestic Gas</td>
<td style="text-align: right;">131.38</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">Domestic ‘Other Fuels’</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Areas</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: left;">notation</th>
<th style="text-align: left;">boundary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Glasgow City</td>
<td style="text-align: left;">S12000049</td>
<td style="text-align: left;">MULTIPOLYGON (((-…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aberdeen City</td>
<td style="text-align: left;">S12000033</td>
<td style="text-align: left;">POLYGON ((-2.0613…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City of London</td>
<td style="text-align: left;">E09000001</td>
<td style="text-align: left;">MULTIPOLYGON (((-…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Barking and Dagenham</td>
<td style="text-align: left;">E09000002</td>
<td style="text-align: left;">MULTIPOLYGON (((0…</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Barnet</td>
<td style="text-align: left;">E09000003</td>
<td style="text-align: left;">POLYGON ((-0.1819…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bexley</td>
<td style="text-align: left;">E09000004</td>
<td style="text-align: left;">POLYGON ((0.2031 …</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table>
<caption>Sectors</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: right;">sort_priority</th>
<th style="text-align: left;">parent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Commercial</td>
</tr>
<tr class="even">
<td style="text-align: left;">Commercial Gas</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Commercial</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Commercial ‘Other Fuels’</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Commercial</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Domestic</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Domestic Gas</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Domestic</td>
</tr>
<tr class="even">
<td style="text-align: left;">Domestic ‘Other Fuels’</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Domestic</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>I work with data cubes expressed as tidy data. We have a central fact table where each row is an observation and each column a dimension or measurement. The values referenced in the dimensions are in turn described with dimension tables.</p>
<p>This data is normalised, which means that it’s structured to minimise redundancy by removing functional dependencies between rows and columns making the independent pieces distinct and their relations clear.</p>
<p>In this case each dimension value occurs may occur many times in the long fact table. This type of normalised form is also known as a star schema because the large central table is surrounded by smaller ones like the diffraction spikes shining around a star.</p>
<p>As analysts, we want access to all of this information; not just the central fact table. There is useful reference data stored in the dimension tables - like labels for codes, or relations to parent resources that describe hierarchy or, for richer resource types like geographies, we might have boundary polygons.</p>
<p>So how do we work with data like this in data frames?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<div class="cell">
<div class="cell-output-display">
<table style="width:100%;">
<caption>Denormalised Star</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">year</th>
<th style="text-align: left;">year_start</th>
<th style="text-align: left;">year_end</th>
<th style="text-align: left;">area</th>
<th style="text-align: left;">area_notation</th>
<th style="text-align: left;">area_boundary</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">sector_notation</th>
<th style="text-align: right;">sector_sort_priority</th>
<th style="text-align: right;">territorial_emissions</th>
<th style="text-align: left;">unit_of_measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Commercial Electricity</td>
<td style="text-align: left;">commercial-electricity</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">77.19</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Commercial Gas</td>
<td style="text-align: left;">commercial-gas</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">16.69</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Commercial ‘Other Fuels’</td>
<td style="text-align: left;">commercial-other-fuels</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Domestic Electricity</td>
<td style="text-align: left;">domestic-electricity</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">80.64</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Domestic Gas</td>
<td style="text-align: left;">domestic-gas</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">131.38</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Domestic ‘Other Fuels’</td>
<td style="text-align: left;">domestic-other-fuels</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Industry Electricity</td>
<td style="text-align: left;">industry-electricity</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">101.15</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Industry Gas</td>
<td style="text-align: left;">industry-gas</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">33.21</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Large Industrial Installations</td>
<td style="text-align: left;">large-industrial-installations</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">181.10</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Industry ‘Other Fuels’</td>
<td style="text-align: left;">industry-other-fuels</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">20.44</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">Agriculture</td>
<td style="text-align: left;">agriculture</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">LULUCF Net Emissions: Forest land</td>
<td style="text-align: left;">lulucf-net-emissions-forest-land</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-1.65</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">LULUCF Net Emissions: Cropland</td>
<td style="text-align: left;">lulucf-net-emissions-cropland</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">LULUCF Net Emissions: Grassland</td>
<td style="text-align: left;">lulucf-net-emissions-grassland</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">-2.94</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Hartlepool</td>
<td style="text-align: left;">E06000001</td>
<td style="text-align: left;">POLYGON ((-1.24098 54….</td>
<td style="text-align: left;">LULUCF Net Emissions: Wetlands</td>
<td style="text-align: left;">lulucf-net-emissions-wetlands</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">KT-CO2</td>
</tr>
</tbody>
</table>
</div>
</div>
<aside class="notes">
<p>It is possible to work with all these tables separately, joining them on the fly for each analytical pipeline.</p>
<p>This can be quite repetitive so people tend to denormalise the data - realising the result of all the joins in a giant single data frame.</p>
<p>This is no longer normalised since there are dependencies between your columns. That means you need to coordinate changes. We tend to avoid this in the source database because it requires more application code to maintain data integrity. It’s more acceptable for analysis where the data doesn’t change but it does make tables harder to understand. People have to resort to data exploration to uncover the relationships between columns.</p>
<p>Arguably the denormalised data is still tidy particularly if the fact table has a one-to-many join with the dimension tables because the joins add columns but not rows.</p>
<p>It’s nevertheless unwieldly and doesn’t scale well. It quickly get very wide making it harder to inspect the data which discourages people from adding too many columns. We also loose information about which columns belong together. Here Pandas in Python scores a point as you can relate variables by using tuples for column headers.</p>
<p>Perhaps the worst problem though is that we introduce a lot of duplication making our data frames much bigger than they need to be. If you repeat a geographic boundary a hundred times you’ll soon notice the memory requirements shoot up and processing speed slows down.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linked-data-frames" class="title-slide slide level1 center">
<h1>Linked Data Frames</h1>
<p><img data-src="images/logo-cropped.svg" style="float:right" width="300"></p>
<p><span style="font-weight: 200; font-size: 2em;">Robin Gower</span></p>
<p><img data-src="images/swirrl-becoming-small-rect.png" style="height: 2.5em"></p>
<aside class="notes">
<p>I’d like to propose an alternative solution which I’ve implemented with the help of the <code>{vctrs}</code> library. We can use this to store the reference table as an <em>attribute</em> of a dimension vector using the values to look-up resource descriptions.</p>
<p>I’ve released this as the linked data frames package.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>

<section id="what-is-vctrs" class="title-slide slide level1 center">
<h1>What is <code>{vctrs}</code>?</h1>
<img data-src="images/vctrs-logo.png" class="r-stretch" style="float:right">
<aside class="notes">
<p><code>{vctrs}</code> is a developer-focussed package. You don’t need to know about it to use the linked-data-frames package but I’d like to take a moment to draw your attention to it as <code>{vctrs}</code> is what does all the hard work here.</p>
<p>Among other things, you can use <code>{vctrs}</code> to create new vector types in R much more easily than using S3 directly.</p>
<p>We don’t have time to get into the details of how this works but the <code>{vctrs}</code> vignette on S3-Vectors is truely first rate documentation.</p>
<p>I will however explain a few gotchas toward the end of the talk that show cases where the abstraction leaks and some care is needed to avoid subtle bugs.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>

<section>
<section id="what-is-linked-data" class="title-slide slide level1 center">
<h1>What is linked-data?</h1>
<aside class="notes">
<p>Before we get stuck into the code I’d like to take a step back to provide some more context.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<p><img data-src="images/example-graph.jpg"></p>
<aside class="notes">
<p>I work with linked-data. This uses the Resource Description Framework (or RDF) which expresses information about resources using a knowledge graph.</p>
<p>Resources in the knowledge graph are described with triples relating a subject (node) with a predicate (edge) to an object (node). Here in the centre we see “BOB” (the subject) “is interested in” (the predicate) “The Mona Lisa” (the object).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<p><img data-src="images/example-graph-iris.jpg"></p>
<aside class="notes">
<p>In linked-data, all the nodes and edges are Uniform Resource Identifiers (or URIs). That means you can look them up on the web and get back a definition. The object nodes can also be literal datatypes like strings and numbers.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="encoding-graphs-as-triples" class="slide level2">
<h2>Encoding graphs as triples</h2>
<pre class="turtle"><code>BASE   &lt;http://example.org/&gt;
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;
PREFIX schema: &lt;http://schema.org/&gt;
PREFIX dcterms: &lt;http://purl.org/dc/terms/&gt;
PREFIX wd: &lt;http://www.wikidata.org/entity/&gt;

&lt;bob#me&gt;
    a foaf:Person ;
    foaf:knows &lt;alice#me&gt; ;
    schema:birthDate "1990-07-04"^^xsd:date ;
    foaf:topic_interest wd:Q12418 .

wd:Q12418
    dcterms:title "Mona Lisa" ;
    dcterms:creator &lt;http://dbpedia.org/resource/Leonardo_da_Vinci&gt; .

&lt;http://data.europeana.eu/item/04802/243FA8618938F4117025F17A8B813C5F9AA4D619&gt;
    dcterms:subject wd:Q12418 .</code></pre>
<aside class="notes">
<p>We can serialise these triples into a format like turtle. This groups blocks of statements about the same subject, with each predicate-object pair in the description separated by semi-colons and terminated with a period. Namespace prefixes help to make the URIs legible. Here we building on five other web ontologies which define URIs for us to use.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="melting-tidy-data-to-triples" class="slide level2">
<h2>Melting tidy data to triples</h2>
<pre class="turtle"><code>BASE   &lt;http://example.org/&gt;
PREFIX dimension: &lt;http://example.org/dimension/&gt;
PREFIX measure: &lt;http://example.org/measure/&gt;
PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
PREFIX geosparql: &lt;http://www.opengis.net/ont/geosparql#&gt;

&lt;obs#1&gt;
  dimension:year &lt;year#2005&gt; ;
  dimension:area &lt;area#hartlepool&gt; ;
  dimension:sector &lt;sector#commercial-electricity&gt; ;
  measure:emissions 77.19 .

&lt;year#2005&gt;
  rdfs:label "2005" .
  
&lt;area#hartlepool&gt;
  rdfs:label "Hartlepool" ;
  geosparql:hasGeometry &lt;geometry#hartlepool&gt; .

&lt;geometry#hartlepool&gt;
  geosparql:asWKT "POLYGON ((-1.24098 54.72318, -1.24401 54.72157 ... ))" .

&lt;sector#commercial-electricity&gt;
  rdfs:label "Commercial Electricity" ;
  ui:sortPriority 1 .</code></pre>
<aside class="notes">
<p>You can think of this as a further form of normalisation. We melt tidy data down into statements relating the observation-row with a column-variable to the cell-value.</p>
<p>We can do the same thing with the reference tables.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-linked-open-data-cloud" class="slide level2">
<h2>The linked open-data cloud</h2>
<img data-src="images/swirrl-lod-cloud.png" class="r-stretch">
<aside class="notes">
<p>In my work with a company called Swirrl, we publish billions of these triples describing hundreds of data cubes and millions of reference resources. This contributes to the linked-open-data cloud which connects datasets across many disciplines.</p>
<p>In particular, our work on the Integrated Data Programme which is an initiative from the UK’s Office for National Statistics and other Government departments has focussed on disseminating tidy data cubes.</p>
<p>It’s this work that motivated the creation of the linked-data-frames package - to help R users download tables of resources from the knowledge graph and assemble it into idiomatic data frames in R.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="working-with-ldf-resources" class="title-slide slide level1 center">
<h1>Working with LDF Resources</h1>
<aside class="notes">
<p>Let’s explore that idiomatic representation from the ground-up. We’ll start at the beginning and see how we can use the linked-data-frames package to create vectors of richly-described resources.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="creating-resources" class="slide level2">
<h2>Creating resources</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>uris <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"http://example.net/id/apple"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"http://example.net/id/banana"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"http://example.net/id/carrot"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple"</span>, <span class="st">"Banana"</span>, <span class="st">"Carrot"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>descriptions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">uri=</span>uris, <span class="at">label=</span>labels)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>(food <span class="ot">&lt;-</span> <span class="fu">resource</span>(uris, descriptions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ldf_resource[3]&gt;
[1] Apple  Banana Carrot
Description: uri, label</code></pre>
</div>
</div>
<aside class="notes">
<p>We start with a vector of URIs that identify each resource.</p>
<p>We record the descriptions in a data frame that <em>must</em> at least include a variable called <code>uri</code> that will be used to find the corresponding description for each resource.</p>
<p>We create LDF resources with the vector of identifiers and the data frame of descriptions.</p>
<p>If you include a variable called <code>label</code> in the description, this will be used by the <code>format()</code> generic when printing to the console. We also print out a list of the variables present in the description.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="repeating-resources" class="slide level2">
<h2>Repeating resources</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(kitchen <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dish=</span><span class="fu">c</span>(<span class="st">"Fruit Salad"</span>, <span class="st">"Fruit Salad"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Carrot Salad"</span>, <span class="st">"Carrot Salad"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">food=</span><span class="fu">resource</span>(<span class="fu">c</span>(<span class="st">"http://example.net/id/apple"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"http://example.net/id/banana"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"http://example.net/id/apple"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"http://example.net/id/carrot"</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                descriptions),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">quantity=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  dish         food       quantity
  &lt;chr&gt;        &lt;ldf_rsrc&gt;    &lt;dbl&gt;
1 Fruit Salad  Apple             2
2 Fruit Salad  Banana            2
3 Carrot Salad Apple             1
4 Carrot Salad Carrot            3</code></pre>
</div>
</div>
<aside class="notes">
<p>Because we’re identifying resources with URIs and not by a ordinal index, you can include repetitions in the URI vector without needing to duplicate descriptions.</p>
<p>We can treat the rich multi-dimensional description as a scalar value. We can use a URI to stand-in for the object while it’s description is stored elsewhere, orthogonally.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="accessing-descriptions" class="slide level2">
<h2>Accessing descriptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">uri</span>(food)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "http://example.net/id/apple"  "http://example.net/id/banana"
[3] "http://example.net/id/carrot"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">description</span>(food)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           uri  label
1  http://example.net/id/apple  Apple
2 http://example.net/id/banana Banana
3 http://example.net/id/carrot Carrot</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">property</span>(food, <span class="st">"label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Apple"  "Banana" "Carrot"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>food[<span class="fu">label</span>(food) <span class="sc">==</span> <span class="st">"Apple"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ldf_resource[1]&gt;
[1] Apple
Description: uri, label</code></pre>
</div>
</div>
<aside class="notes">
<p>LDF provides accessors for the identifiers and descriptions. You can also select individual properties. Since labels are so ubiquitous, we have a dedicated accessor for them.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="loading-data" class="title-slide slide level1 center">
<h1>Loading data</h1>
<aside class="notes">
<p>Now we can look at how to load in some existing data from the linked-open-data cloud.</p>
<p>We’ll start by learning about SPARQL a query language for linked-data. Then we’ll see how to use LDF to write SPARQL queries for us. Finally we’ll look at how this approach generalises to work with relational data too.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="tabulating-linked-data-with-sparql" class="slide level2">
<h2>Tabulating linked-data with SPARQL</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>music_genres_query <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="st">PREFIX : &lt;http://dbpedia.org/ontology/&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT * WHERE {</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">  ?uri a :MusicGenre;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">    rdfs:label ?label;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">    rdfs:comment ?comment</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="st">    .</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">} LIMIT 100</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>(music_genre_results <span class="ot">&lt;-</span> <span class="fu">query</span>(music_genres_query, <span class="at">endpoint=</span><span class="st">"http://dbpedia.org/sparql/"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 3
   uri                                            label              comment    
   &lt;chr&gt;                                          &lt;chr&gt;              &lt;chr&gt;      
 1 http://dbpedia.org/resource/Art_rock           Art rock           "Art rock …
 2 http://dbpedia.org/resource/Bebop              Bebop              "Bebop or …
 3 http://dbpedia.org/resource/Britpop            Britpop            "Britpop w…
 4 http://dbpedia.org/resource/Bubblegum_pop      Bubblegum pop      "Bubblegum…
 5 http://dbpedia.org/resource/Fighting_game      Fighting game      "A fightin…
 6 http://dbpedia.org/resource/Free_improvisation Free improvisation "Free impr…
 7 http://dbpedia.org/resource/Greek_hip_hop      Greek hip hop      "Greek hip…
 8 http://dbpedia.org/resource/Grunge             Grunge             "Grunge (s…
 9 http://dbpedia.org/resource/Historical_fiction Historical fiction "Historica…
10 http://dbpedia.org/resource/Morality_play      Morality play      "The moral…
# … with 90 more rows</code></pre>
</div>
</div>
<aside class="notes">
<p>The triples we saw earlier can be kept in databases called triplestores. We can query triplestores with the <a href="w3.org/TR/sparql11-query">SPARQL query language</a> which matches triple patterns.</p>
<p>Here we find the first 100 music genres in dbpedia and extract a label and comment in English. We describe a pattern for a resource of type Music Genre that has a label and a comment. The variables, with names starting with a question mark, are bound to the matching values in the result table.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>music_genres <span class="ot">&lt;-</span> <span class="fu">resource</span>(music_genre_results<span class="sc">$</span>uri, <span class="at">description=</span>music_genre_results)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># find music genres where the comment mentions "dance"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>music_genres[<span class="fu">grep</span>(<span class="st">"dance"</span>, <span class="fu">property</span>(music_genres, <span class="st">"comment"</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ldf_resource[12]&gt;
 [1] Polka                          Trance music                  
 [3] Vaudeville                     Zarzuela                      
 [5] Afro/Cosmic music              Benga music                   
 [7] Bubblegum dance                Waltz (International Standard)
 [9] Logobi                         Sega (genre)                  
[11] K-pop                          Western swing                 
Description: uri, label, comment</code></pre>
</div>
</div>
<aside class="notes">
<p>We can use this table to create LDF resources and then reach into the description while grepping the genres to match against the comment - helping us find dance music genres.</p>
<p>You’ll need a fair bit of domain knowledge to write SPARQL queries - both in terms of SPARQL itself as well as the vocabularies used in the data. The LDF package seeks to take care of this problem by writing queries for you.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ldfget_cube" class="slide level2">
<h2><code>ldf::get_cube</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-overflow-wrap code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_cube</span>(<span class="st">"http://gss-data.org.uk/data/gss_data/climate-change/beis-2005-to-2019-local-authority-carbon-dioxide-co2-emissions#dataset"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">endpoint=</span><span class="st">"https://beta.gss-data.org.uk/sparql"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 129,388 × 5
   year       area       sector                         territorial_emissions
   &lt;ldf_ntrv&gt; &lt;ldf_rsrc&gt; &lt;ldf_rsrc&gt;                                     &lt;dbl&gt;
 1 2005       Hartlepool Commercial Electricity                         77.2 
 2 2005       Hartlepool Commercial Gas                                 16.7 
 3 2005       Hartlepool Commercial 'Other Fuels'                        0.2 
 4 2005       Hartlepool Domestic Electricity                           80.6 
 5 2005       Hartlepool Domestic Gas                                  131.  
 6 2005       Hartlepool Domestic 'Other Fuels'                          4.07
 7 2005       Hartlepool Industry Electricity                          101.  
 8 2005       Hartlepool Industry Gas                                   33.2 
 9 2005       Hartlepool Large Industrial Installations                181.  
10 2005       Hartlepool Industry 'Other Fuels'                         20.4 
# … with 129,378 more rows, and 1 more variable: unit_of_measure &lt;ldf_rsrc&gt;</code></pre>
</div>
</div>
<div class="footer">
<p>Read more about <a href="https://swirrl.github.io/linked-data-frames/reference/index.html#section-downloading-datacubes">downloading linked-data</a> in the package documentation.</p>
</div>
<aside class="notes">
<p>LDF provides a set of functions for assembling linked-data frames from datasets published according to the RDF Data Cube standard. This is mostly captured under the top-level porcelain <code>get_cube</code> which builds on top of plumbing to orchestrate a set of SPARQL queries.</p>
<p>These queries first download a tidy table of URIs for the observations and then, for each column, descriptions are downloaded for all the reference data. The results are assembled into a linked data frame.</p>
<p>Hidden behind each of these <code>ldf_resource</code> column types is one of the related tables from the star schema we saw at the beginning.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># English Local Authority areas with the highest emissions from transport</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(transport_emissions <span class="ot">&lt;-</span> emissions <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sector <span class="sc">%&gt;%</span> <span class="fu">property</span>(<span class="st">"parent"</span>) <span class="sc">%&gt;%</span> <span class="fu">label</span>() <span class="sc">==</span> <span class="st">"Transport"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(area) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_emissions=</span><span class="fu">sum</span>(territorial_emissions)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="sc">-</span>total_emissions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 379 × 2
   area                      total_emissions
   &lt;ldf_rsrc&gt;                          &lt;dbl&gt;
 1 Leeds                              25831.
 2 Birmingham                         22273.
 3 Buckinghamshire                    21006.
 4 Wiltshire                          19024.
 5 Cheshire East                      17929.
 6 Cornwall                           15703.
 7 Cheshire West and Chester          14393.
 8 County Durham                      14210.
 9 South Gloucestershire              14013.
10 Doncaster                          13778.
# … with 369 more rows</code></pre>
</div>
</div>
<aside class="notes">
<p>Now we can apply the full power of R to our linked-data frame.</p>
<p>Here we’re using <code>{dplyr}</code> to filter, group and aggregate the data.</p>
<p>The filter reaches into the sector column to find the parent sector, this in turn is also a resource with a label which we can match against a string.</p>
<p>Notice the group by also returns the original resource areas, carrying the descriptions through for further analysis.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<div class="cell">

</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>transport_emissions_map <span class="ot">&lt;-</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">description</span>(transport_emissions<span class="sc">$</span>area) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(boundary)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">wkt=</span><span class="st">"boundary"</span>, <span class="at">crs=</span><span class="st">"WGS84"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">mutate</span>(transport_emissions,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">geo=</span><span class="fu">uri</span>(area)),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="fu">c</span>(<span class="st">"uri"</span><span class="ot">=</span><span class="st">"geo"</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(transport_emissions_map) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">log</span>(total_emissions)),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"white"</span>, <span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">"KT-CO2"</span>) <span class="sc">+</span> </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Transport Emissions"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span><span class="st">"Total 2005-2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="slides_files/figure-revealjs/unnamed-chunk-23-1.png" width="480"></p>
</div>
</div>
</div>
<aside class="notes">
<p>As we saw earlier those descriptions include Well-Known-Text (or WKT) boundaries provided by ONS Geography linked-data endpoint. We can use these to draw a map.</p>
<p>This example does require us to denormalise our nested tabular structure though. The simple features (<code>{sf}</code>) package expects the geometries and values be in the one data frame, so we need to take the area description and then attach the measure to that before charting.</p>
<p>This is a nice demonstration of how the knowledge graph approach allows publishers to attach arbitrary information to describe resources in their datasets. Data consumers can then enjoy richly described data which reduces the amount of preparation and enrichment we have to do ourselves. Indeed from here we could also use the URIs to link this data to other datasets, letting links in the knowledge graph tell us how the data fits together.</p>
<p>Although the SPARQL example and the <code>get_cube</code> wrapper are extracting linked-data from a graph, we’re still working with tabular data to create the resource descriptions. Indeed we can also use this approach to create resources with relational data.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linking-relational-data" class="slide level2">
<h2>Linking relational data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>flights_ldf <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">carrier=</span><span class="fu">resource</span>(carrier, <span class="fu">rename</span>(airlines, <span class="at">uri=</span>carrier)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">origin=</span><span class="fu">resource</span>(origin, <span class="fu">rename</span>(airports, <span class="at">uri=</span>faa), <span class="at">fill_missing=</span>T),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dest=</span><span class="fu">resource</span>(dest, <span class="fu">rename</span>(airports, <span class="at">uri=</span>faa), <span class="at">fill_missing=</span>T),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tailnum=</span><span class="fu">resource</span>(tailnum, <span class="fu">rename</span>(planes, <span class="at">uri=</span>tailnum), <span class="at">fill_missing=</span>T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>flights_ldf <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">distance=</span>spatialrisk<span class="sc">::</span><span class="fu">haversine</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">property</span>(origin, <span class="st">"lat"</span>), <span class="fu">property</span>(origin, <span class="st">"lon"</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">property</span>(dest, <span class="st">"lat"</span>), <span class="fu">property</span>(dest, <span class="st">"lon"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  (<span class="cf">function</span>(d) <span class="fu">qplot</span>(d<span class="sc">$</span>distance<span class="sc">/</span><span class="dv">1000</span>, <span class="at">xlab=</span><span class="st">"Kilometers travelled to/ from NYC"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="slides_files/figure-revealjs/unnamed-chunk-26-1.png" width="1056"></p>
</div>
</div>
<aside class="notes">
<p>We can demonstrate how this works on a relational database using the NYC flights dataset.</p>
<p>We take the central flights table then replace the foreign keys with the related objects themselves. That is to say, LDF resources described using the related tables.</p>
<p>Note that we’ve had to invoke the <code>fill_missing</code> flag as the descriptions in the package are incomplete.</p>
<p>We now have a single data frame containing all the reference data wired-up correctly. This makes it easy to work with relational data using <code>dplyr</code> and <code>ggplot</code> too.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="gotchas" class="title-slide slide level1 center">
<h1>Gotchas</h1>
<p>Lessons for working with <code>{vctrs}</code></p>
<aside class="notes">
<p>The vctrs package is an ambitious attempt to overhaul some of the inner workings of R. This can lead to a few unexpected results as some base R functions aren’t forward compatible.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dispatching-on-base-type" class="slide level2">
<h2>Dispatching on base type</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kitchen<span class="sc">$</span>food)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 http://example.net/id/apple http://example.net/id/banana 
                           2                            1 
http://example.net/id/carrot 
                           1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">label</span>(kitchen<span class="sc">$</span>food))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Apple Banana Carrot 
     2      1      1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>kitchen_labels <span class="ot">&lt;-</span> <span class="fu">as_dataframe_of_labels</span>(kitchen)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(kitchen_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4 obs. of  3 variables:
 $ dish    : chr  "Fruit Salad" "Fruit Salad" "Carrot Salad" "Carrot Salad"
 $ food    : chr  "Apple" "Banana" "Apple" "Carrot"
 $ quantity: num  2 2 1 3</code></pre>
</div>
</div>
<aside class="notes">
<p>Because the underlying type of resources is character, R will tend dispatch on this basis for base functions or any other packages that aren’t expecting these novel S3 vectors.</p>
<p>This can be unexpected. The <code>table()</code> function, for example, returns counts by URI not label as we might expect. We deliberately have <code>as.character()</code> return the URI and not the label as it’s the URI that’s designed to represent the resource. You can of course tabulate the labels explicitly instead.</p>
<p>More generally LDF offers an escape hatch to convert a linked data frame back into a “normal” data frame (i.e.&nbsp;one not containing vectors of RDF resources) using the <code>as_dataframe_of_labels()</code> function. This converts all the RDF resources into their labels.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="use-vctrs-to-retain-descriptions" class="slide level2">
<h2>Use <code>{vctrs}</code> to retain descriptions</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r=</span><span class="fu">resource</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(<span class="at">uri=</span><span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>))),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">v=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  r v
1 A 1
2 B 2</code></pre>
</div>
</div>
</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r=</span><span class="fu">resource</span>(<span class="fu">c</span>(<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">data.frame</span>(<span class="at">uri=</span><span class="fu">c</span>(<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="fu">c</span>(<span class="st">"B"</span>,<span class="st">"C"</span>))),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">v=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  r v
1 B 3
2 C 4</code></pre>
</div>
</div>
</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only takes first descriptions</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so the label "C" is missing</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(d1, d2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>   r v
1 A  1
2 B  2
3 B  3
4 NA 4</code></pre>
</div>
</div>
</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merges descriptions</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all the labels are retained</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>vctrs<span class="sc">::</span><span class="fu">vec_rbind</span>(d1, d2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  r v
1 A 1
2 B 2
3 B 3
4 C 4</code></pre>
</div>
</div>
</div>
<aside class="notes">
<p>You can also become unstuck in less obvious ways. The humble <code>rbind</code> function doesn’t attempt to merge attributes so the combined result only has descriptions from the first input and is thus missing a label for the “C” resource which is only described in the second input. You need to use the more robust <code>vec_rbind</code> function provided by the vctrs package to ensure the descriptions are combined.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="tidyverse-is-vctrs-aware" class="slide level2">
<h2>Tidyverse is <code>{vctrs}</code>-aware</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(d1, d2, <span class="at">by=</span><span class="st">"r"</span>, <span class="at">all=</span>T) <span class="co"># C label missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   r v.x v.y
1 A    1  NA
2 B    2   3
3 NA  NA   4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">full_join</span>(d1, d2, <span class="at">by=</span><span class="st">"r"</span>) <span class="co"># merges descriptions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r v.x v.y
1 A   1  NA
2 B   2   3
3 C  NA   4</code></pre>
</div>
</div>
<aside class="notes">
<p>Likewise, the <code>base::merge()</code> function will only retain the descriptions of the left-hand data frame.</p>
<p>This is fine for left-joins or inner-joins (with <code>merge(all=F)</code>) but for right- or full-joins you’ll need to use dplyr instead as this uses <code>vctrs</code> underneath.</p>
<p>We expose a <code>merge_description()</code> function to help outside of the tidyverse.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="try-it-for-yourself" class="title-slide slide level1 center">
<h1>Try it for yourself</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"Swirrl/linked-data-frames"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ldf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>If this talk has aroused your interest you can check out the package on github.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="learn-more" class="slide level2">
<h2>Learn more</h2>
<dl>
<dt>Documentation for the <code>{vctrs}</code> package</dt>
<dd>
<a href="https://vctrs.r-lib.org">vctrs.r-lib.org</a>
</dd>
<dt>Documentation for the <code>{ldf}</code> package</dt>
<dd>
<a href="https://swirrl.github.io/linked-data-frames/index.html">swirrl.github.io/linked-data-frames</a>
</dd>
<dt>Data Cubes from by the Integrated Data Programme</dt>
<dd>
<a href="beta.gss-data.org.uk/">beta.gss-data.org.uk</a>
</dd>
<dt>Linked-data schema used by PublishMyData</dt>
<dd>
<a href="https://ontologies.publishmydata.com/">ontologies.publishmydata.com</a>
</dd>
<dt>Occasional tweets from me</dt>
<dd>
<a href="https://twitter.com/robsteranium"><span class="citation" data-cites="robsteranium">@robsteranium</span></a>
</dd>
</dl>
<aside class="notes">
<p>Finally here are some links if you’d like to know more.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>